
**См. также:**  
- [[Как ViewModel переживает поворот экрана]]

---

Любой экземпляр `ViewModel` следует получать через `ViewModelProvider`. Этот провайдер выполняет две ключевые задачи:

1. **Поиск/создание**
   - Проверяет хранилище `ViewModelStore` по ключу:
     - если экземпляр есть — возвращает его;
     - если нет — создаёт новый и сохраняет.

2. **Управление жизненным циклом**
   - «Проживает» вместе с компонентом (Activity/Fragment), переживая конфигурационные изменения (например, поворот экрана), но очищается при окончательном уничтожении компонента.

---
## Что такое `ViewModelStore`

- По сути, это **Map<String, ViewModel>**:
  - **ключ** — строка (обычно полное имя класса или заданный тег);
  - **значение** — соответствующий экземпляр `ViewModel`.  
- Хранится внутри любого компонента, реализующего интерфейс `ViewModelStoreOwner`.

---
## `ViewModelStoreOwner`

- Интерфейс, который реализуют все Jetpack-компоненты:
  - `ComponentActivity` (включая `AppCompatActivity`),
  - `FragmentActivity`,
  - `Fragment` и другие.  
- При вызове `ViewModelProvider(owner)` фреймворк через `owner.getViewModelStore()` получает доступ к хранилищу и обеспечивает долговременное существование `ViewModel` до тех пор, пока `owner` не будет окончательно уничтожен.
